##
# Chamilo Minimal Intrusion Detection System (IDS)
#
# Controls the IntrusionDetectionSubscriber which scans URL query parameters,
# the request URI and selected HTTP headers for common attack signatures
# (SQLi, XSS, PathTraversal, CmdInjection, Scanner probes).
#
# Events are logged to var/logs/ids/ids_events.log with daily rotation.
# The admin interface is available at /admin/security/simple-ids.
#
# Override any value in your .env (or .env.local for dev) without touching this file.
##

parameters:
    # Defaults applied when the env vars are absent.
    env(IDS_ENABLED): 'true'
    env(IDS_BLOCK): 'false'
    env(IDS_SECURITY_HEADERS): 'false'

    # IDS_ENABLED: set to 'false' to disable all scanning (logging and headers).
    chamilo.ids.enabled: '%env(bool:IDS_ENABLED)%'

    # IDS_BLOCK: set to 'true' to reject detected requests with HTTP 400.
    #            When 'false' (default) suspicious requests are only logged.
    chamilo.ids.block_on_detection: '%env(bool:IDS_BLOCK)%'

    # IDS_SECURITY_HEADERS: set to 'false' to skip OWASP response-header injection
    #            (X-Frame-Options, X-Content-Type-Options, Referrer-Policy, etc.).
    chamilo.ids.security_headers: '%env(bool:IDS_SECURITY_HEADERS)%'
